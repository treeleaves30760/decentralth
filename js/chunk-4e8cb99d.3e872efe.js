(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4e8cb99d"],{"0538":function(e,t,r){"use strict";var n=r("da84"),i=r("e330"),o=r("59ed"),s=r("861d6"),a=r("1a2d"),c=r("f36a"),u=r("40d5"),d=n.Function,l=i([].concat),h=i([].join),p={},f=function(e,t,r){if(!a(p,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";p[t]=d("C,a","return new C("+h(n,",")+")")}return p[t](e,r)};e.exports=u?d.bind:function(e){var t=o(this),r=t.prototype,n=c(arguments,1),i=function(){var r=l(n,c(arguments));return this instanceof i?f(t,r.length,r):t.apply(e,r)};return s(r)&&(i.prototype=r),i}},"0676":function(e,t,r){function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r("d9e2"),e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},"11b0":function(e,t,r){function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),r("a630"),e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},"11d3":function(e,t,r){(function(t){var n=r("e372").Transform,i=r("3022").inherits,o=r("53a8");function s(e){n.call(this,e),this._destroyed=!1}function a(e,t,r){r(null,e)}function c(e){return function(t,r,n){return"function"==typeof t&&(n=r,r=t,t={}),"function"!=typeof r&&(r=a),"function"!=typeof n&&(n=null),e(t,r,n)}}i(s,n),s.prototype.destroy=function(e){if(!this._destroyed){this._destroyed=!0;var r=this;t.nextTick((function(){e&&r.emit("error",e),r.emit("close")}))}},e.exports=c((function(e,t,r){var n=new s(e);return n._transform=t,r&&(n._flush=r),n})),e.exports.ctor=c((function(e,t,r){function n(t){if(!(this instanceof n))return new n(t);this.options=o(e,t),s.call(this,this.options)}return i(n,s),n.prototype._transform=t,r&&(n.prototype._flush=r),n})),e.exports.obj=c((function(e,t,r){var n=new s(o({objectMode:!0,highWaterMark:16},e));return n._transform=t,r&&(n._flush=r),n}))}).call(this,r("4362"))},1465:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return Q}));var n=r("9523"),i=r.n(n),o=r("7037"),s=r.n(o),a=r("c973"),c=r.n(a),u=r("970b"),d=r.n(u),l=r("5bc3"),h=r.n(l),p=r("a34a"),f=r.n(p),b=r("b888"),g=r("6517"),m=r("399f"),y=r.n(m),v=r("3337"),w=r("ac4f"),_=r.n(w),x=r("5ba3"),O=r("5c7d"),k=r.n(O),S=r("ed6d"),E=r.n(S),P=r("6b58"),C=r.n(P),I=r("36c6"),j=r.n(I),A=r("a128"),T=r.n(A),R=r("448a"),M=r.n(R),D=k.a.getLogger("torus.js");function N(e){var t=L();return function(){var r,n=j()(e);if(t){var i=j()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return C()(this,r)}}function L(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function U(e){return e.charAt(0).toUpperCase()+e.slice(1)}D.disableAll();var V=function(e){E()(r,e);var t=N(r);function r(e){var n,i=e.errors,o=e.responses,s=e.predicate;return d()(this,r),n=t.call(this,"Unable to resolve enough promises."),n.errors=i,n.responses=o,n.predicate=s,n}return h()(r)}(T()(Error)),q=function(e,t){return new Promise((function(r,n){var i,o=0,s={resolved:!1},a=new Array(e.length).fill(void 0),c=new Array(e.length).fill(void 0);e.forEach((function(u,d){u.then((function(e){c[d]=e})).catch((function(e){a[d]=e})).finally((function(){s.resolved||t(c.slice(0),s).then((function(e){s.resolved=!0,r(e)})).catch((function(e){i=e})).finally((function(t){if(o+=1,o===e.length){var r=Object.values(c.reduce((function(e,t){var r,n=t||{},i=n.id,o=n.error;return(null===o||void 0===o||null===(r=o.data)||void 0===r?void 0:r.length)>0&&(o.data.startsWith("Error occurred while verifying params")?e[i]=U(o.data):e[i]=o.data),e}),{}));if(r.length>0){var s=r.length>1?"\n".concat(r.map((function(e){return"• ".concat(e)})).join("\n")):r[0];n(new Error(s))}else{var u;n(new V({errors:a,responses:c,predicate:(null===(u=i)||void 0===u?void 0:u.message)||i}))}}}))}))}))}))};function F(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?F(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function W(e){var t=B();return function(){var r,n=j()(e);if(t){var i=j()(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return C()(this,r)}}function B(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}var z=function(e){E()(r,e);var t=W(r);function r(){return d()(this,r),t.apply(this,arguments)}return h()(r)}(T()(Error)),H=function e(t,r){var n=t;if("number"===typeof n&&(n=Array.from({length:n},(function(e,t){return t}))),r>n.length||r<=0)return[];if(r===n.length)return[n];if(1===r)return n.reduce((function(e,t){return[].concat(M()(e),[[t]])}),[]);for(var i=[],o=[],s=0;s<=n.length-r+1;s+=1){o=e(n.slice(s+1),r-1);for(var a=0;a<o.length;a+=1)i.push([n[s]].concat(M()(o[a])))}return i},Y=function(e,t){for(var r={},n=0;n<e.length;n+=1){var i=_()(e[n]);if(r[i]=r[i]?r[i]+1:1,r[i]===t)return e[n]}},J=function(){var e=c()(f.a.mark((function e(t,r,n){var i;return f.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=t.map((function(e){return Object(g["d"])(e,Object(g["a"])("VerifierLookupRequest",{verifier:r,verifier_id:n.toString()})).catch((function(e){return D.error("lookup request failed",e)}))})),e.abrupt("return",q(i,(function(e){var r=e.filter((function(e){return e})),n=Y(r.map((function(e){return e&&e.error})),1+~~(t.length/2)),i=Y(r.map((function(e){return e&&e.result})),1+~~(t.length/2));return i||n?Promise.resolve({keyResult:i,errorResult:n}):Promise.reject(new Error("invalid results ".concat(JSON.stringify(e))))})));case 2:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),X=function(e,t,r,n){return new Promise((function(i,o){setTimeout((function(){J(e,t,r).then(i).catch(o)}),n)}))},G=function(){var e=c()(f.a.mark((function e(t,r,n,i,o,s){var a,c,u,d,l;return f.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(void 0===n?(a=Math.floor(Math.random()*t.length),c=a):a=n%t.length,a!==i){e.next=3;break}throw new Error("Looped through all");case 3:return void 0!==i&&(c=i),u=Object(g["a"])("KeyAssign",{verifier:o,verifier_id:s.toString()}),e.prev=5,e.next=8,Object(g["d"])("https://signer.tor.us/api/sign",u,{headers:{pubKeyX:r[a].X,pubKeyY:r[a].Y}},{useAPIKey:!0});case 8:return d=e.sent,e.abrupt("return",Object(g["d"])(t[a],K(K({},u),d),{headers:{"Content-Type":"application/json; charset=utf-8"}}));case 12:if(e.prev=12,e.t0=e["catch"](5),D.error(e.t0),l=["Timed out","TypeError: Failed to fetch","TypeError: cancelled","TypeError: NetworkError when attempting to fetch resource."],!l.includes(e.t0.message)){e.next=18;break}return e.abrupt("return",G(t,r,a+1,c,o,s));case 18:throw new Error("Sorry, the Torus Network that powers Web3Auth is currently very busy.\n    We will generate your key in time. Pls try again later. \n\n    ".concat(e.t0.message||""));case 19:case"end":return e.stop()}}),e,null,[[5,12]])})));return function(t,r,n,i,o,s){return e.apply(this,arguments)}}();function Z(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function $(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Z(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Q=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.enableOneKey,n=void 0!==r&&r,i=e.metadataHost,o=void 0===i?"https://metadata.tor.us":i,s=e.allowHost,a=void 0===s?"https://signer.tor.us/api/allow":s,c=e.serverTimeOffset,u=void 0===c?0:c;d()(this,t),this.ec=new v["ec"]("secp256k1"),this.metadataHost=o,this.allowHost=a,this.enableOneKey=n,this.serverTimeOffset=u||0}return h()(t,[{key:"getUserTypeAndAddress",value:function(){var e=c()(f.a.mark((function e(t,r,n){var i,o,s,a,c,u,d,l,h,p,b,g,m,v,w,_,x,O,k,S,E,P=arguments;return f.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=n.verifier,o=n.verifierId,s=P.length>3&&void 0!==P[3]&&P[3],e.next=4,J(t,i,o);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0={};case 7:if(a=e.t0,c=a.keyResult,u=a.errorResult,d=!1,!u||!JSON.stringify(u).includes("Verifier + VerifierID has not yet been assigned")){e.next=26;break}if(s){e.next=14;break}throw new Error("Verifier + VerifierID has not yet been assigned");case 14:return e.next=16,G(t,r,void 0,void 0,i,o);case 16:return e.next=18,X(t,i,o,1e3);case 18:if(e.t1=e.sent,e.t1){e.next=21;break}e.t1={};case 21:h=e.t1,l=h.keyResult,d=!0,e.next=31;break;case 26:if(!c){e.next=30;break}l=c,e.next=31;break;case 30:throw new Error("node results do not match at first lookup ".concat(JSON.stringify(c||{}),", ").concat(JSON.stringify(u||{})));case 31:if(!l){e.next=61;break}return p=l.keys[0],b=p.pub_key_X,g=p.pub_key_Y,e.prev=33,e.next=37,this.getOrSetNonce(b,g,void 0,!d);case 37:O=e.sent,m=O.typeOfUser,v=O.nonce,w=O.pubNonce,x=O.upgraded,v=new y.a(v||"0",16),e.next=48;break;case 45:throw e.prev=45,e.t2=e["catch"](33),new z;case 48:if("v1"!==m){e.next=52;break}_=this.ec.keyFromPublic({x:b.toString(16),y:g.toString(16)}).getPublic().add(this.ec.keyFromPrivate(v.toString(16)).getPublic()),e.next=57;break;case 52:if("v2"!==m){e.next=56;break}_=this.ec.keyFromPublic({x:b.toString(16),y:g.toString(16)}).getPublic().add(this.ec.keyFromPublic({x:w.x,y:w.y}).getPublic()),e.next=57;break;case 56:throw new Error("getOrSetNonce should always return typeOfUser.");case 57:return k=_.getX().toString(16),S=_.getY().toString(16),E=this.generateAddressFromPubKey(_.getX(),_.getY()),e.abrupt("return",{typeOfUser:m,nonce:v,pubNonce:w,upgraded:x,X:k,Y:S,address:E});case 61:throw new Error("node results do not match at final lookup ".concat(JSON.stringify(c||{}),", ").concat(JSON.stringify(u||{})));case 62:case"end":return e.stop()}}),e,this,[[33,45]])})));function t(t,r,n){return e.apply(this,arguments)}return t}()},{key:"setCustomKey",value:function(){var e=c()(f.a.mark((function e(t){var r,n,i,o,s,a,c,u,d;return f.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=t.privKeyHex,n=t.metadataNonce,i=t.torusKeyHex,o=t.customKeyHex,i?s=new y.a(i,16):(a=new y.a(r,16),s=a.sub(n).umod(this.ec.curve.n)),c=new y.a(o,16),u=c.sub(s).umod(this.ec.curve.n),d=this.generateMetadataParams(u.toString(16),s.toString(16)),e.next=7,this.setMetadata(d);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"retrieveShares",value:function(){var t=c()(f.a.mark((function t(r,n,i,o,a){var u,d,l,h,p,m,v,w,_,O=this,k=arguments;return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return u=k.length>5&&void 0!==k[5]?k[5]:{},d=[],t.next=4,Object(g["b"])(this.allowHost,{headers:{verifier:i,verifier_id:o.verifier_id}},{useAPIKey:!0});case 4:for(l=Object(b["generatePrivate"])(),h=Object(b["getPublic"])(l).toString("hex"),p=h.slice(2,66),m=h.slice(66),v=Object(x["keccak256"])(a),w=0;w<r.length;w+=1)_=Object(g["d"])(r[w],Object(g["a"])("CommitmentRequest",{messageprefix:"mug00",tokencommitment:v.slice(2),temppubx:p,temppuby:m,verifieridentifier:i})).catch((function(e){return D.error("commitment",e)})),d.push(_);return t.abrupt("return",q(d,(function(e){var t=e.filter((function(e){return!(!e||"object"!==s()(e))&&!e.error}));return t.length>=3*~~(r.length/4)+1?Promise.resolve(e):Promise.reject(new Error("invalid ".concat(JSON.stringify(e))))})).then((function(t){for(var s=[],d=[],h=0;h<t.length;h+=1)t[h]&&d.push(t[h].result);for(var p=0;p<r.length;p+=1){var m=Object(g["d"])(r[p],Object(g["a"])("ShareRequest",{encrypted:"yes",item:[$($({},o),{},{idtoken:a,nodesignatures:d,verifieridentifier:i},u)]})).catch((function(e){return D.error("share req",e)}));s.push(m)}return q(s,function(){var t=c()(f.a.mark((function t(i,o){var s,a,c,u,d,h,p,g,m,v,w,_,x;return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(s=i.filter((function(e){return e})),a=Y(i.map((function(e){return e&&e.result&&e.result.keys[0].PublicKey})),1+~~(r.length/2)),!(s.length>=1+~~(r.length/2)&&a)){t.next=25;break}for(c=[],u=[],d=0;d<i.length;d+=1)i[d]&&i[d].result&&i[d].result.keys&&i[d].result.keys.length>0?(i[d].result.keys.sort((function(e,t){return new y.a(e.Index,16).cmp(new y.a(t.Index,16))})),i[d].result.keys[0].Metadata?(h={ephemPublicKey:e.from(i[d].result.keys[0].Metadata.ephemPublicKey,"hex"),iv:e.from(i[d].result.keys[0].Metadata.iv,"hex"),mac:e.from(i[d].result.keys[0].Metadata.mac,"hex"),mode:e.from(i[d].result.keys[0].Metadata.mode,"hex")},c.push(Object(b["decrypt"])(l,$($({},h),{},{ciphertext:e.from(atob(i[d].result.keys[0].Share).padStart(64,"0"),"hex")})).catch((function(e){return D.debug("share decryption",e)})))):c.push(Promise.resolve(e.from(i[d].result.keys[0].Share.padStart(64,"0"),"hex")))):c.push(Promise.resolve(void 0)),u.push(new y.a(n[d],16));return t.next=8,Promise.all(c);case 8:if(p=t.sent,!o.resolved){t.next=11;break}return t.abrupt("return",void 0);case 11:g=p.reduce((function(e,t,r){return t&&e.push({index:u[r],value:new y.a(t)}),e}),[]),m=H(g.length,1+~~(r.length/2)),w=function(t){var r=m[t],n=g.filter((function(e,t){return r.includes(t)})),i=n.map((function(e){return e.value})),o=n.map((function(e){return e.index})),s=O.lagrangeInterpolation(i,o),c=Object(b["getPublic"])(e.from(s.toString(16,64),"hex")).toString("hex"),u=c.slice(2,66),d=c.slice(66);if(0===new y.a(u,16).cmp(new y.a(a.X,16))&&0===new y.a(d,16).cmp(new y.a(a.Y,16)))return v=s,"break"},_=0;case 15:if(!(_<m.length)){t.next=22;break}if(x=w(_),"break"!==x){t.next=19;break}return t.abrupt("break",22);case 19:_+=1,t.next=15;break;case 22:if(void 0!==v){t.next=24;break}throw new Error("could not derive private key");case 24:return t.abrupt("return",v);case 25:throw new Error("invalid");case 26:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())})).then(function(){var t=c()(f.a.mark((function t(r){var n,i,o,s,a,c,u,d;return f.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=r,i=Object(b["getPublic"])(e.from(n.toString(16,64),"hex")).toString("hex"),o=i.slice(2,66),s=i.slice(66),!O.enableOneKey){t.next=12;break}return t.next=7,O.getNonce(o,s,n);case 7:c=t.sent,u=c.nonce,a=new y.a(u||"0",16),t.next=15;break;case 12:return t.next=14,O.getMetadata({pub_key_X:o,pub_key_Y:s});case 14:a=t.sent;case 15:return D.debug("> torus.js/retrieveShares",{privKey:n.toString(16),metadataNonce:a.toString(16)}),n=n.add(a).umod(O.ec.curve.n),d=O.generateAddressFromPrivKey(n),D.debug("> torus.js/retrieveShares",{ethAddress:d,privKey:n.toString(16)}),t.abrupt("return",{ethAddress:d,privKey:n.toString("hex",64),metadataNonce:a});case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 11:case"end":return t.stop()}}),t,this)})));function r(e,r,n,i,o){return t.apply(this,arguments)}return r}()},{key:"getMetadata",value:function(){var e=c()(f.a.mark((function e(t,r){var n;return f.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(g["d"])("".concat(this.metadataHost,"/get"),t,r,{useAPIKey:!0});case 3:if(n=e.sent,n&&n.message){e.next=6;break}return e.abrupt("return",new y.a(0));case 6:return e.abrupt("return",new y.a(n.message,16));case 9:return e.prev=9,e.t0=e["catch"](0),D.error("get metadata error",e.t0),e.abrupt("return",new y.a(0));case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"generateMetadataParams",value:function(t,r){var n=this.ec.keyFromPrivate(r.toString("hex",64)),i={data:t,timestamp:new y.a(~~(this.serverTimeOffset+Date.now()/1e3)).toString(16)},o=n.sign(Object(x["keccak256"])(_()(i)).slice(2));return{pub_key_X:n.getPublic().getX().toString("hex"),pub_key_Y:n.getPublic().getY().toString("hex"),set_data:i,signature:e.from(o.r.toString(16,64)+o.s.toString(16,64)+new y.a(o.v).toString(16,2),"hex").toString("base64")}}},{key:"setMetadata",value:function(){var e=c()(f.a.mark((function e(t,r){var n;return f.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(g["d"])("".concat(this.metadataHost,"/set"),t,r,{useAPIKey:!0});case 3:return n=e.sent,e.abrupt("return",n.message);case 7:return e.prev=7,e.t0=e["catch"](0),D.error("set metadata error",e.t0),e.abrupt("return","");case 11:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(t,r){return e.apply(this,arguments)}return t}()},{key:"lagrangeInterpolation",value:function(e,t){if(e.length!==t.length)return null;for(var r=new y.a(0),n=0;n<e.length;n+=1){for(var i=new y.a(1),o=new y.a(1),s=0;s<e.length;s+=1)if(n!==s){i=i.mul(t[s].neg()),i=i.umod(this.ec.curve.n);var a=t[n].sub(t[s]);a=a.umod(this.ec.curve.n),o=o.mul(a).umod(this.ec.curve.n)}var c=i.mul(o.invm(this.ec.curve.n)).umod(this.ec.curve.n);c=c.mul(e[n]).umod(this.ec.curve.n),r=r.add(c)}return r.umod(this.ec.curve.n)}},{key:"generateAddressFromPrivKey",value:function(t){var r=this.ec.keyFromPrivate(t.toString("hex",64),"hex"),n=r.getPublic().encode("hex").slice(2),i="0x".concat(Object(x["keccak256"])(e.from(n,"hex")).slice(26));return Object(x["toChecksumAddress"])(i)}},{key:"generateAddressFromPubKey",value:function(t,r){var n=this.ec.keyFromPublic({x:t.toString("hex",64),y:r.toString("hex",64)}),i=n.getPublic().encode("hex").slice(2),o="0x".concat(Object(x["keccak256"])(e.from(i,"hex")).slice(26));return Object(x["toChecksumAddress"])(o)}},{key:"getPublicAddress",value:function(){var e=c()(f.a.mark((function e(t,r,n){var i,o,s,a,c,u,d,l,h,p,b,g,m,v,w,_,x,O,k,S,E=arguments;return f.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=n.verifier,o=n.verifierId,s=E.length>3&&void 0!==E[3]&&E[3],D.debug("> torus.js/getPublicAddress",{endpoints:t,torusNodePubs:r,verifier:i,verifierId:o,isExtended:s}),c=!1,e.next=6,J(t,i,o);case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0={};case 9:if(u=e.t0,d=u.keyResult,l=u.errorResult,!l||!JSON.stringify(l).includes("Verifier not supported")){e.next=16;break}throw new Error("Verifier not supported. Check if you: \n\n      1. Are on the right network (Torus testnet/mainnet) \n\n      2. Have setup a verifier on dashboard.web3auth.io?");case 16:if(!l||!JSON.stringify(l).includes("Verifier + VerifierID has not yet been assigned")){e.next=29;break}return e.next=19,G(t,r,void 0,void 0,i,o);case 19:return e.next=21,X(t,i,o,1e3);case 21:if(e.t1=e.sent,e.t1){e.next=24;break}e.t1={};case 24:h=e.t1,a=h.keyResult,c=!0,e.next=34;break;case 29:if(!d){e.next=33;break}a=d,e.next=34;break;case 33:throw new Error("node results do not match at first lookup ".concat(JSON.stringify(d||{}),", ").concat(JSON.stringify(l||{})));case 34:if(D.debug("> torus.js/getPublicAddress",{finalKeyResult:a,isNewKey:c}),!a){e.next=76;break}if(b=a.keys[0],g=b.pub_key_X,m=b.pub_key_Y,!this.enableOneKey){e.next=64;break}return e.prev=38,e.next=42,this.getOrSetNonce(g,m,void 0,!c);case 42:k=e.sent,v=k.typeOfUser,w=k.nonce,_=k.pubNonce,O=k.upgraded,w=new y.a(w||"0",16),e.next=53;break;case 50:throw e.prev=50,e.t2=e["catch"](38),new z;case 53:if("v1"!==v){e.next=57;break}x=this.ec.keyFromPublic({x:g.toString(16),y:m.toString(16)}).getPublic().add(this.ec.keyFromPrivate(w.toString(16)).getPublic()),e.next=62;break;case 57:if("v2"!==v){e.next=61;break}x=O?this.ec.keyFromPublic({x:g.toString(16),y:m.toString(16)}).getPublic():this.ec.keyFromPublic({x:g.toString(16),y:m.toString(16)}).getPublic().add(this.ec.keyFromPublic({x:_.x,y:_.y}).getPublic()),e.next=62;break;case 61:throw new Error("getOrSetNonce should always return typeOfUser.");case 62:e.next=69;break;case 64:return v="v1",e.next=67,this.getMetadata({pub_key_X:g,pub_key_Y:m});case 67:w=e.sent,x=this.ec.keyFromPublic({x:g.toString(16),y:m.toString(16)}).getPublic().add(this.ec.keyFromPrivate(w.toString(16)).getPublic());case 69:if(g=x.getX().toString(16),m=x.getY().toString(16),S=this.generateAddressFromPubKey(x.getX(),x.getY()),D.debug("> torus.js/getPublicAddress",{X:g,Y:m,address:S,typeOfUser:v,nonce:null===(p=w)||void 0===p?void 0:p.toString(16),pubNonce:_}),s){e.next=75;break}return e.abrupt("return",S);case 75:return e.abrupt("return",{typeOfUser:v,address:S,X:g,Y:m,metadataNonce:w,pubNonce:_});case 76:throw new Error("node results do not match at final lookup ".concat(JSON.stringify(d||{}),", ").concat(JSON.stringify(l||{})));case 77:case"end":return e.stop()}}),e,this,[[38,50]])})));function t(t,r,n){return e.apply(this,arguments)}return t}()},{key:"getOrSetNonce",value:function(){var e=c()(f.a.mark((function e(t,r,n){var i,o,s,a=arguments;return f.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=a.length>3&&void 0!==a[3]&&a[3],s=i?"getNonce":"getOrSetNonce",o=n?this.generateMetadataParams(s,n):{pub_key_X:t,pub_key_Y:r,set_data:{data:s}},e.abrupt("return",Object(g["d"])("".concat(this.metadataHost,"/get_or_set_nonce"),o,void 0,{useAPIKey:!0}));case 4:case"end":return e.stop()}}),e,this)})));function t(t,r,n){return e.apply(this,arguments)}return t}()},{key:"getNonce",value:function(){var e=c()(f.a.mark((function e(t,r,n){return f.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getOrSetNonce(t,r,n,!0));case 1:case"end":return e.stop()}}),e,this)})));function t(t,r,n){return e.apply(this,arguments)}return t}()},{key:"getPostboxKeyFrom1OutOf1",value:function(e,t){var r=new y.a(e,16),n=new y.a(t,16);return r.sub(n).umod(this.ec.curve.n).toString("hex")}}],[{key:"enableLogging",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?D.enableAll():D.disableAll()}},{key:"setAPIKey",value:function(e){Object(g["f"])(e)}},{key:"setEmbedHost",value:function(e){Object(g["g"])(e)}},{key:"isGetOrSetNonceError",value:function(e){return e instanceof z}}]),t}()}).call(this,r("b639").Buffer)},2236:function(e,t,r){var n=r("5a43");function i(e){if(Array.isArray(e))return n(e)}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},2966:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.serializeError=t.isValidCode=t.getMessageFromCode=t.JSON_RPC_SERVER_ERROR_MESSAGE=void 0;const n=r("e017"),i=r("e369"),o=n.errorCodes.rpc.internal,s="Unspecified error message. This is a bug, please report it.",a={code:o,message:c(o)};function c(e,r=s){if(Number.isInteger(e)){const r=e.toString();if(p(n.errorValues,r))return n.errorValues[r].message;if(l(e))return t.JSON_RPC_SERVER_ERROR_MESSAGE}return r}function u(e){if(!Number.isInteger(e))return!1;const t=e.toString();return!!n.errorValues[t]||!!l(e)}function d(e,{fallbackError:t=a,shouldIncludeStack:r=!1}={}){var n,o;if(!t||!Number.isInteger(t.code)||"string"!==typeof t.message)throw new Error("Must provide fallback error with integer number code and string message.");if(e instanceof i.EthereumRpcError)return e.serialize();const s={};if(e&&"object"===typeof e&&!Array.isArray(e)&&p(e,"code")&&u(e.code)){const t=e;s.code=t.code,t.message&&"string"===typeof t.message?(s.message=t.message,p(t,"data")&&(s.data=t.data)):(s.message=c(s.code),s.data={originalError:h(e)})}else{s.code=t.code;const r=null===(n=e)||void 0===n?void 0:n.message;s.message=r&&"string"===typeof r?r:t.message,s.data={originalError:h(e)}}const d=null===(o=e)||void 0===o?void 0:o.stack;return r&&e&&d&&"string"===typeof d&&(s.stack=d),s}function l(e){return e>=-32099&&e<=-32e3}function h(e){return e&&"object"===typeof e&&!Array.isArray(e)?Object.assign({},e):e}function p(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.JSON_RPC_SERVER_ERROR_MESSAGE="Unspecified server error.",t.getMessageFromCode=c,t.isValidCode=u,t.serializeError=d},3410:function(e,t,r){var n=r("23e7"),i=r("d039"),o=r("7b0b"),s=r("e163"),a=r("e177"),c=i((function(){s(1)}));n({target:"Object",stat:!0,forced:c,sham:!a},{getPrototypeOf:function(e){return s(o(e))}})},"36c6":function(e,t,r){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(t)}r("3410"),e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},"3c96":function(e,t,r){function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r("d9e2"),e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},4082:function(e,t,r){r("a4d3");var n=r("f0e4");function i(e,t){if(null==e)return{};var r,i,o=n(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)r=s[i],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},"448a":function(e,t,r){var n=r("2236"),i=r("11b0"),o=r("6613"),s=r("0676");function a(e){return n(e)||i(e)||o(e)||s()}e.exports=a,e.exports.__esModule=!0,e.exports["default"]=e.exports},"4a4b":function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports["default"]=e.exports,r(t,n)}e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports},"4ae1":function(e,t,r){var n=r("23e7"),i=r("d066"),o=r("2ba4"),s=r("0538"),a=r("5087"),c=r("825a"),u=r("861d6"),d=r("7c73"),l=r("d039"),h=i("Reflect","construct"),p=Object.prototype,f=[].push,b=l((function(){function e(){}return!(h((function(){}),[],e)instanceof e)})),g=!l((function(){h((function(){}))})),m=b||g;n({target:"Reflect",stat:!0,forced:m,sham:m},{construct:function(e,t){a(e),c(t);var r=arguments.length<3?e:a(arguments[2]);if(g&&!b)return h(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return o(f,n,t),new(o(s,e,n))}var i=r.prototype,l=d(u(i)?i:p),m=o(e,l,t);return u(m)?m:l}})},"4df4":function(e,t,r){"use strict";var n=r("da84"),i=r("0366"),o=r("c65b"),s=r("7b0b"),a=r("9bdd"),c=r("e95a"),u=r("68ee"),d=r("07fa"),l=r("8418"),h=r("9a1f"),p=r("35a1"),f=n.Array;e.exports=function(e){var t=s(e),r=u(this),n=arguments.length,b=n>1?arguments[1]:void 0,g=void 0!==b;g&&(b=i(b,n>2?arguments[2]:void 0));var m,y,v,w,_,x,O=p(t),k=0;if(!O||this==f&&c(O))for(m=d(t),y=r?new this(m):f(m);m>k;k++)x=g?b(t[k],k):t[k],l(y,k,x);else for(w=h(t,O),_=w.next,y=r?new this:[];!(v=o(_,w)).done;k++)x=g?a(w,b,[v.value,k],!0):v.value,l(y,k,x);return y.length=k,y}},"4ec9":function(e,t,r){"use strict";var n=r("6d61"),i=r("6566");n("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),i)},"4fad":function(e,t,r){var n=r("d039"),i=r("861d6"),o=r("c6b6"),s=r("d86b"),a=Object.isExtensible,c=n((function(){a(1)}));e.exports=c||s?function(e){return!!i(e)&&((!s||"ArrayBuffer"!=o(e))&&(!a||a(e)))}:a},"5a43":function(e,t){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}e.exports=r,e.exports.__esModule=!0,e.exports["default"]=e.exports},"5bc3":function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function n(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},6566:function(e,t,r){"use strict";var n=r("9bf2").f,i=r("7c73"),o=r("e2cc"),s=r("0366"),a=r("19aa"),c=r("2266"),u=r("7dd0"),d=r("2626"),l=r("83ab"),h=r("f183").fastKey,p=r("69f3"),f=p.set,b=p.getterFor;e.exports={getConstructor:function(e,t,r,u){var d=e((function(e,n){a(e,p),f(e,{type:t,index:i(null),first:void 0,last:void 0,size:0}),l||(e.size=0),void 0!=n&&c(n,e[u],{that:e,AS_ENTRIES:r})})),p=d.prototype,g=b(t),m=function(e,t,r){var n,i,o=g(e),s=y(e,t);return s?s.value=r:(o.last=s={index:i=h(t,!0),key:t,value:r,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=s),n&&(n.next=s),l?o.size++:e.size++,"F"!==i&&(o.index[i]=s)),e},y=function(e,t){var r,n=g(e),i=h(t);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==t)return r};return o(p,{clear:function(){var e=this,t=g(e),r=t.index,n=t.first;while(n)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete r[n.index],n=n.next;t.first=t.last=void 0,l?t.size=0:e.size=0},delete:function(e){var t=this,r=g(t),n=y(t,e);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first==n&&(r.first=i),r.last==n&&(r.last=o),l?r.size--:t.size--}return!!n},forEach:function(e){var t,r=g(this),n=s(e,arguments.length>1?arguments[1]:void 0);while(t=t?t.next:r.first){n(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!y(this,e)}}),o(p,r?{get:function(e){var t=y(this,e);return t&&t.value},set:function(e,t){return m(this,0===e?0:e,t)}}:{add:function(e){return m(this,e=0===e?0:e,e)}}),l&&n(p,"size",{get:function(){return g(this).size}}),d},setStrong:function(e,t,r){var n=t+" Iterator",i=b(t),o=b(n);u(e,t,(function(e,t){f(this,{type:n,target:e,state:i(e),kind:t,last:void 0})}),(function(){var e=o(this),t=e.kind,r=e.last;while(r&&r.removed)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),d(t)}}},6613:function(e,t,r){r("fb6a"),r("d3b7"),r("b0c0"),r("a630"),r("3ca3"),r("ac1f"),r("00b4");var n=r("5a43");function i(e,t){if(e){if("string"===typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},"694b":function(e,t,r){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(i=n;0!==i--;)if(!e(t[i],r[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(o=Object.keys(t),n=o.length,n!==Object.keys(r).length)return!1;for(i=n;0!==i--;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;0!==i--;){var s=o[i];if(!e(t[s],r[s]))return!1}return!0}return t!==t&&r!==r}},"6b58":function(e,t,r){r("d9e2");var n=r("7037")["default"],i=r("3c96");function o(e,t){if(t&&("object"===n(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)}e.exports=o,e.exports.__esModule=!0,e.exports["default"]=e.exports},"6d61":function(e,t,r){"use strict";var n=r("23e7"),i=r("da84"),o=r("e330"),s=r("94ca"),a=r("6eeb"),c=r("f183"),u=r("2266"),d=r("19aa"),l=r("1626"),h=r("861d6"),p=r("d039"),f=r("1c7e"),b=r("d44e"),g=r("7156");e.exports=function(e,t,r){var m=-1!==e.indexOf("Map"),y=-1!==e.indexOf("Weak"),v=m?"set":"add",w=i[e],_=w&&w.prototype,x=w,O={},k=function(e){var t=o(_[e]);a(_,e,"add"==e?function(e){return t(this,0===e?0:e),this}:"delete"==e?function(e){return!(y&&!h(e))&&t(this,0===e?0:e)}:"get"==e?function(e){return y&&!h(e)?void 0:t(this,0===e?0:e)}:"has"==e?function(e){return!(y&&!h(e))&&t(this,0===e?0:e)}:function(e,r){return t(this,0===e?0:e,r),this})},S=s(e,!l(w)||!(y||_.forEach&&!p((function(){(new w).entries().next()}))));if(S)x=r.getConstructor(t,e,m,v),c.enable();else if(s(e,!0)){var E=new x,P=E[v](y?{}:-0,1)!=E,C=p((function(){E.has(1)})),I=f((function(e){new w(e)})),j=!y&&p((function(){var e=new w,t=5;while(t--)e[v](t,t);return!e.has(-0)}));I||(x=t((function(e,t){d(e,_);var r=g(new w,e,x);return void 0!=t&&u(t,r[v],{that:r,AS_ENTRIES:m}),r})),x.prototype=_,_.constructor=x),(C||j)&&(k("delete"),k("has"),m&&k("get")),(j||P)&&k(v),y&&_.clear&&delete _.clear}return O[e]=x,n({global:!0,forced:x!=w},O),b(x,e),y||r.setStrong(x,e,m),x}},"6d79":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ethErrors=void 0;const n=r("e369"),i=r("2966"),o=r("e017");function s(e,t){const[r,o]=c(t);return new n.EthereumRpcError(e,r||i.getMessageFromCode(e),o)}function a(e,t){const[r,o]=c(t);return new n.EthereumProviderError(e,r||i.getMessageFromCode(e),o)}function c(e){if(e){if("string"===typeof e)return[e];if("object"===typeof e&&!Array.isArray(e)){const{message:t,data:r}=e;if(t&&"string"!==typeof t)throw new Error("Must specify string message.");return[t||void 0,r]}}return[]}t.ethErrors={rpc:{parse:e=>s(o.errorCodes.rpc.parse,e),invalidRequest:e=>s(o.errorCodes.rpc.invalidRequest,e),invalidParams:e=>s(o.errorCodes.rpc.invalidParams,e),methodNotFound:e=>s(o.errorCodes.rpc.methodNotFound,e),internal:e=>s(o.errorCodes.rpc.internal,e),server:e=>{if(!e||"object"!==typeof e||Array.isArray(e))throw new Error("Ethereum RPC Server errors must provide single object argument.");const{code:t}=e;if(!Number.isInteger(t)||t>-32005||t<-32099)throw new Error('"code" must be an integer such that: -32099 <= code <= -32005');return s(t,e)},invalidInput:e=>s(o.errorCodes.rpc.invalidInput,e),resourceNotFound:e=>s(o.errorCodes.rpc.resourceNotFound,e),resourceUnavailable:e=>s(o.errorCodes.rpc.resourceUnavailable,e),transactionRejected:e=>s(o.errorCodes.rpc.transactionRejected,e),methodNotSupported:e=>s(o.errorCodes.rpc.methodNotSupported,e),limitExceeded:e=>s(o.errorCodes.rpc.limitExceeded,e)},provider:{userRejectedRequest:e=>a(o.errorCodes.provider.userRejectedRequest,e),unauthorized:e=>a(o.errorCodes.provider.unauthorized,e),unsupportedMethod:e=>a(o.errorCodes.provider.unsupportedMethod,e),disconnected:e=>a(o.errorCodes.provider.disconnected,e),chainDisconnected:e=>a(o.errorCodes.provider.chainDisconnected,e),custom:e=>{if(!e||"object"!==typeof e||Array.isArray(e))throw new Error("Ethereum Provider custom errors must provide single object argument.");const{code:t,message:r,data:i}=e;if(!r||"string"!==typeof r)throw new Error('"message" must be a nonempty string');return new n.EthereumProviderError(t,r,i)}}}},"6f8f":function(e,t,r){function n(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}r("d3b7"),r("f8c9"),r("4ae1"),e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},7037:function(e,t,r){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(t)}r("a4d3"),r("e01a"),r("d3b7"),r("d28b"),r("3ca3"),r("ddb0"),e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},"71a9":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ObservableStore=void 0;const i=n(r("163d"));class o extends i.default{constructor(e){super(),this._state=e||{}}getState(){return this._getState()}putState(e){this._putState(e),this.emit("update",e)}updateState(e){if(e&&"object"===typeof e){const t=this.getState();this.putState(Object.assign(Object.assign({},t),e))}else this.putState(e)}subscribe(e){this.on("update",e)}unsubscribe(e){this.removeListener("update",e)}_getState(){return this._state}_putState(e){this._state=e}}t.ObservableStore=o},8124:function(e,t,r){"use strict";r.r(t),r.d(t,"TorusWalletAdapter",(function(){return De}));var n=r("9523"),i=r.n(n),o=r("4082"),s=r.n(o),a=r("6e11"),c=r.n(a),u=r("5ba3");const d={ROPSTEN:"ropsten",MAINNET:"mainnet"},l=[{constant:!0,inputs:[],name:"currentEpoch",outputs:[{internalType:"uint256",name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"uint256",name:"epoch",type:"uint256"}],name:"getEpochInfo",outputs:[{internalType:"uint256",name:"id",type:"uint256"},{internalType:"uint256",name:"n",type:"uint256"},{internalType:"uint256",name:"k",type:"uint256"},{internalType:"uint256",name:"t",type:"uint256"},{internalType:"address[]",name:"nodeList",type:"address[]"},{internalType:"uint256",name:"prevEpoch",type:"uint256"},{internalType:"uint256",name:"nextEpoch",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{internalType:"address",name:"nodeAddress",type:"address"}],name:"getNodeDetails",outputs:[{internalType:"string",name:"declaredIp",type:"string"},{internalType:"uint256",name:"position",type:"uint256"},{internalType:"uint256",name:"pubKx",type:"uint256"},{internalType:"uint256",name:"pubKy",type:"uint256"},{internalType:"string",name:"tmP2PListenAddress",type:"string"},{internalType:"string",name:"p2pListenAddress",type:"string"}],payable:!1,stateMutability:"view",type:"function"}];
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function h(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,o){function s(e){try{c(n.next(e))}catch(t){o(t)}}function a(e){try{c(n["throw"](e))}catch(t){o(t)}}function c(e){e.done?r(e.value):i(e.value).then(s,a)}c((n=n.apply(e,t||[])).next())}))}class p{constructor({network:e=d.MAINNET,proxyAddress:t="0x638646503746d5456209e33a2ff5e3226d698bea"}={}){let r;this._currentEpoch="19",this._torusNodeEndpoints=["https://torus-19.torusnode.com/jrpc","https://torus-node.ens.domains/jrpc","https://torus-node.matic.network/jrpc","https://torus.zilliqa.network/jrpc","https://torus-mainnet.cosmos.network/jrpc","https://torus2.etherscan.com/jrpc","https://torus-node-v2.skalelabs.com/jrpc","https://torus-node.binancex.dev/jrpc","https://torusnode.ont.io/jrpc"],this._torusNodePub=[{X:"bbe83c64177c3775550e6ba6ac2bc059f6847d644c9e4894e42c60d7974d8c2b",Y:"82b49a7caf70def38cdad2740af45c1e4f969650105c5019a29bb18b21a9acb5"},{X:"c208cac4ef9a47d386097a9c915b28e9cb89213abee8d26a17198ee261201b0d",Y:"c7db2fe4631109f40833de9dc78d07e35706549ee48fa557b33e4e75e1047873"},{X:"ca1766bb426d4ca5582818a0c5439d560ea64f5baa060793ab29dd3d0ceacfe",Y:"d46c1d08c40e1306e1bca328c2287b8268166b11a1ba4b8442ea2ad0c5e32152"},{X:"c3934dd2f6f4b3d2e1e398cc501e143c1e1a381b52feb6d1525af34d16253768",Y:"71f5141a5035799099f5ea3e241e66946bc55dc857ac3bd7d6fcdb8dcd3eeeef"},{X:"22e66f1929631d00bf026227581597f085fd94fd952fc0dca9f0833398b5c064",Y:"6088b3912e10a1e9d50355a609c10db7d188f16a2e2fd7357e51bf4f6a74f0a1"},{X:"9dc9fa410f3ce9eb70df70cdea00a49f2c4cc7a31c08c0dab5f863ed35ff5139",Y:"627a291cb87a75c61da3f65d6818e1e05e360217179817ed27e8c73bca7ec122"},{X:"118b9fc07e97b096d899b9f6658463ce6a8caa64038e37fc969df4e6023dd8c6",Y:"baf9fa4e51770f4796ea165dd03a769b8606681a38954a0a92c4cbffd6609ce9"},{X:"8a6d8b925da15a273dec3d8f8395ec35cd6878f274b2b180e4e106999db64043",Y:"96f67f870c157743da0b1eb84d89bf30500d74dc84c11f501ee1cb013acc8c46"},{X:"39cecb62e863729f572f7dfc46c24867981bf04bb405fed0df39e33984bfade5",Y:"61c2364434012e68a2be2e9952805037e52629d7762fafc8e10e9fb5bad8f790"}],this._torusIndexes=[1,2,3,4,5,6,7,8,9],this._network=d.MAINNET;try{const t=new URL(e);r=t.href}catch(n){const t="b8cdb0e4cff24599a286bf8e87ff1c96";r=`https://${e}.infura.io/v3/${t}`}c.a.setProvider(r),this.nodeListContract=new c.a(l,t),this.nodeListAddress=t,this.updated=!1,this._network=e}get _nodeDetails(){return{currentEpoch:this._currentEpoch,nodeListAddress:this.nodeListAddress,torusNodeEndpoints:this._torusNodeEndpoints,torusNodePub:this._torusNodePub,torusIndexes:this._torusIndexes,updated:this.updated}}getCurrentEpoch(){return this.nodeListContract.methods.currentEpoch().call()}getEpochInfo(e){return this.nodeListContract.methods.getEpochInfo(e).call()}getNodeEndpoint(e){return this.nodeListContract.methods.getNodeDetails(e).call()}getNodeDetails(e=!1,t=!1){return h(this,void 0,void 0,(function*(){try{if(e&&this._network===d.MAINNET)return this._nodeDetails;if(this.updated)return this._nodeDetails;const r=yield this.getCurrentEpoch();if(t&&this._network===d.MAINNET&&r===this._currentEpoch)return this._nodeDetails;this._currentEpoch=r;const n=yield this.getEpochInfo(r),i=n.nodeList.map((e,t)=>t+1);this._torusIndexes=i;const o=n.nodeList.map(e=>this.getNodeEndpoint(e)),s=yield Promise.all(o),a=[],c=[];for(let e=0;e<s.length;e+=1){const t=s[e],r=`https://${t.declaredIp.split(":")[0]}/jrpc`;a.push(r),c.push({X:Object(u["toHex"])(t.pubKx).replace("0x",""),Y:Object(u["toHex"])(t.pubKy).replace("0x","")})}return this._torusNodeEndpoints=a,this._torusNodePub=c,this.updated=!0,this._nodeDetails}catch(r){return this._nodeDetails}}))}}var f=r("6517"),b=r("2d5d"),g=r("1465"),m=r("da81"),y=r.n(m),v=r("95b2"),w=r("8cd5"),_=r("694b"),x=r.n(_);function O(e){return null!==e&&"object"===typeof e&&"function"===typeof e.pipe}function k(e){return O(e)&&!1!==e.writable&&"function"===typeof e._write&&"object"===typeof e._writableState}function S(e){return O(e)&&!1!==e.readable&&"function"===typeof e._read&&"object"===typeof e._readableState}function E(e){return k(e)&&S(e)}var P=r("6f59"),C=r.n(P),I=r("5c7d"),j=r.n(I),A=r("98e6"),T=r.n(A),R=r("faa1");const M={GOOGLE:"google",FACEBOOK:"facebook",TWITCH:"twitch",REDDIT:"reddit",DISCORD:"discord"},D={[M.GOOGLE]:"tkey-google",[M.FACEBOOK]:"tkey-facebook",[M.TWITCH]:"tkey-twitch",[M.REDDIT]:"tkey-reddit",[M.DISCORD]:"tkey-discord"},N={MOONPAY:"moonpay",WYRE:"wyre",RAMPNETWORK:"rampnetwork",XANPOOL:"xanpool",MERCURYO:"mercuryo",TRANSAK:"transak"},L={PRODUCTION:"production",DEVELOPMENT:"development",BINANCE:"binance",TESTING:"testing",LRC:"lrc",BETA:"beta"},U={BOTTOM_LEFT:"bottom-left",TOP_LEFT:"top-left",BOTTOM_RIGHT:"bottom-right",TOP_RIGHT:"top-right"},V={[N.RAMPNETWORK]:{line1:"Debit Card/ Apple Pay/ Bank transfer",line2:"0.49% - 2.9%",line3:"5,000€/purchase, 20,000€/mo",supportPage:"https://instant.ramp.network/",minOrderValue:50,maxOrderValue:2e4,validCurrencies:["GBP","EUR","USD"],validCryptoCurrencies:["ETH","DAI","USDC","BSC_BNB"],includeFees:!0,enforceMax:!1},[N.MOONPAY]:{line1:"Credit / Debit Card / Apple Pay",line2:"4.5% or 5 USD",line3:"2,000€/day, 10,000€/mo",supportPage:"https://help.moonpay.io/en/",minOrderValue:24.99,maxOrderValue:5e4,validCurrencies:["USD","EUR","GBP","AUD","CAD","SGD","RUB"],validCryptoCurrencies:["ETH","DAI","TUSD","USDC","USDT","BNB_BSC","BUSD_BSC"],includeFees:!0,enforceMax:!1},[N.WYRE]:{line1:"Apple Pay/ Debit/ Credit Card",line2:"4.9% + 30¢ or 5 USD",line3:"$250/day",supportPage:"https://support.sendwyre.com/en/",minOrderValue:5,maxOrderValue:500,validCurrencies:["USD","AUD","CAD","GBP","EUR"],validCryptoCurrencies:["ETH","DAI","USDC","USDT"],includeFees:!1,enforceMax:!1},[N.XANPOOL]:{line1:"PayNow/ InstaPay/ FPS/ GoJekPay/ UPI/ PromptPay/ VietelPay/ DuitNow",line2:"2.5% buying, 3% selling",line3:"$2,500 / day",supportPage:"mailto:support@xanpool.com",minOrderValue:100,maxOrderValue:2500,validCurrencies:["SGD","HKD","MYR","PHP","INR","VND","THB","IDR"],validCryptoCurrencies:["ETH","USDT"],includeFees:!0,sell:!0,enforceMax:!1},[N.MERCURYO]:{line1:"Credit/ Debit Card/ Apple Pay",line2:"3.95% or 4 USD",line3:"10,000€/day, 25,000€/mo",supportPage:"mailto:support@mercuryo.io",minOrderValue:30,maxOrderValue:5e3,validCurrencies:["USD","EUR","RUB","TRY","GBP","UAH"],validCryptoCurrencies:["ETH","DAI","BAT","USDT","OKB"],includeFees:!0,enforceMax:!1},[N.TRANSAK]:{line1:"Credit/ Debit Card/ <br/>Bank Transfer (sepa/gbp)",line2:"0.99% - 5.5% or 5 USD",line3:"500€/day",supportPage:"https://support.transak.com/hc/en-US",minOrderValue:20,maxOrderValue:500,validCurrencies:["USD","EUR","GBP","AUD","CAD","SGD"],validCryptoCurrencies:["ETH","DAI","USDC","USDT"],includeFees:!0,enforceMax:!1}},q={en:{embed:{continue:"Continue",actionRequired:"Authorization required",pendingAction:"Click continue to proceed with your request in a popup",cookiesRequired:"Cookies Required",enableCookies:"Please enable cookies in your browser preferences to access Torus",clickHere:"More Info"}},de:{embed:{continue:"Fortsetzen",actionRequired:"Autorisierung erforderlich",pendingAction:"Klicken Sie in einem Popup auf Weiter, um mit Ihrer Anfrage fortzufahren",cookiesRequired:"Cookies benötigt",enableCookies:"Bitte aktivieren Sie Cookies in Ihren Browsereinstellungen, um auf Torus zuzugreifen",clickHere:"Mehr Info"}},ja:{embed:{continue:"継続する",actionRequired:"認証が必要です",pendingAction:"続行をクリックして、ポップアップでリクエストを続行します",cookiesRequired:"必要なクッキー",enableCookies:"Torusにアクセスするには、ブラウザの設定でCookieを有効にしてください。",clickHere:"詳しくは"}},ko:{embed:{continue:"계속하다",actionRequired:"승인 필요",pendingAction:"팝업에서 요청을 진행하려면 계속을 클릭하십시오.",cookiesRequired:"쿠키 필요",enableCookies:"브라우저 환경 설정에서 쿠키를 활성화하여 Torus에 액세스하십시오.",clickHere:"더 많은 정보"}},zh:{embed:{continue:"继续",actionRequired:"需要授权",pendingAction:"单击继续以在弹出窗口中继续您的请求",cookiesRequired:"必填Cookie",enableCookies:"请在您的浏览器首选项中启用cookie以访问Torus。",clickHere:"更多信息"}}};var F={supportedVerifierList:[M.GOOGLE,M.REDDIT,M.DISCORD],paymentProviders:V,api:"https://api.tor.us",translations:q,prodTorusUrl:"",localStorageKey:"torus-".concat(window.location.hostname)};const K=e=>new Promise((t,r)=>{null!=window.document.body?Promise.resolve(e()).then(t).catch(r):window.document.addEventListener("DOMContentLoaded",()=>{Promise.resolve(e()).then(t).catch(r)})}),W=e=>{const t=window.document.createElement("template"),r=e.trim();return t.innerHTML=r,t.content.firstChild},B=function(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];const s=()=>{r(...i),e.removeEventListener(t,s)};e.addEventListener(t,s)},z=(e,t,r)=>{const n=i=>{r(i),e.removeListener(t,n)};e.on(t,n)};async function H(){return new Promise(e=>{"loading"!==document.readyState?e():B(document,"DOMContentLoaded",e)})}var Y=j.a.getLogger("torus-embed"),J={errors:{disconnected:()=>"Torus: Lost connection to Torus.",permanentlyDisconnected:()=>"Torus: Disconnected from iframe. Page reload required.",sendSiteMetadata:()=>"Torus: Failed to send site metadata. This is an internal error, please report this bug.",unsupportedSync:e=>"Torus: The Torus Ethereum provider does not support synchronous methods like ".concat(e," without a callback parameter."),invalidDuplexStream:()=>"Must provide a Node.js-style duplex stream.",invalidOptions:(e,t)=>"Invalid options. Received: { maxEventListeners: ".concat(e,", shouldSendMetadata: ").concat(t," }"),invalidRequestArgs:()=>"Expected a single, non-array, object argument.",invalidRequestMethod:()=>"'args.method' must be a non-empty string.",invalidRequestParams:()=>"'args.params' must be an object or array if provided.",invalidLoggerObject:()=>"'args.logger' must be an object if provided.",invalidLoggerMethod:e=>"'args.logger' must include required method '".concat(e,"'.")},info:{connected:e=>'Torus: Connected to chain with ID "'.concat(e,'".')},warnings:{enableDeprecation:'Torus: ""ethereum.enable()" is deprecated and may be removed in the future. Please use "ethereum.send("eth_requestAccounts")" instead. For more information, see: https://eips.ethereum.org/EIPS/eip-1102',sendDeprecation:'Torus: "ethereum.send(...)" is deprecated and may be removed in the future. Please use "ethereum.sendAsync(...)" or "ethereum.request(...)" instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193',events:{close:'Torus: The event "close" is deprecated and may be removed in the future. Please use "disconnect" instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193',data:'Torus: The event "data" is deprecated and will be removed in the future.Use "message" instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193#message',networkChanged:'Torus: The event "networkChanged" is deprecated and may be removed in the future. Please use "chainChanged" instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193',notification:'Torus: The event "notification" is deprecated and may be removed in the future. Please use "message" instead.\nFor more information, see: https://eips.ethereum.org/EIPS/eip-1193'},publicConfigStore:'Torus: The property "publicConfigStore" is deprecated and WILL be removed in the future.'}};const{paymentProviders:X}=F,G=(e,t)=>{const r={};if(!e)return{errors:r,isValid:!0};if(e&&!X[e])return r.provider="Invalid Provider",{errors:r,isValid:0===Object.keys(r).length};const n=X[e],i=t||{};if(i.fiatValue){const e=+parseFloat(i.fiatValue.toString())||0;e<n.minOrderValue&&(r.fiatValue="Requested amount is lower than supported"),e>n.maxOrderValue&&n.enforceMax&&(r.fiatValue="Requested amount is higher than supported")}return i.selectedCurrency&&!n.validCurrencies.includes(i.selectedCurrency)&&(r.selectedCurrency="Unsupported currency"),i.selectedCryptoCurrency&&!n.validCryptoCurrencies.includes(i.selectedCryptoCurrency)&&(r.selectedCryptoCurrency="Unsupported cryptoCurrency"),{errors:r,isValid:0===Object.keys(r).length}};function Z(){return(e,t,r)=>{"string"===typeof e.method&&e.method||(t.error=w["ethErrors"].rpc.invalidRequest({message:"The request 'method' must be a non-empty string.",data:e})),r(e=>{const{error:r}=t;return r?(Y.error("MetaMask - RPC Error: ".concat(r.message),r),e()):e()})}}function $(e,t,r){let n='MetaMask: Lost connection to "'.concat(e,'".');null!==t&&void 0!==t&&t.stack&&(n+="\n".concat(t.stack)),Y.warn(n),r&&r.listenerCount("error")>0&&r.emit("error",n)}const Q=()=>Math.random().toString(36).slice(2),ee=async(e,t)=>{let r,n;const i="1.20.4";let o=t.version||i;try{if(("binance"===e||"production"===e)&&!t.version){let e;e=F.prodTorusUrl?{data:F.prodTorusUrl}:await Object(f["b"])("".concat(F.api,"/latestversion?name=@toruslabs/torus-embed&version=").concat(i),{},{useAPIKey:!0}),o=e.data,F.prodTorusUrl=e.data}}catch(s){Y.error(s,"unable to fetch latest version")}switch(Y.info("version used: ",o),e){case"binance":r="https://binance.tor.us/v".concat(o),n="info";break;case"testing":r="https://testing.tor.us",n="debug";break;case"lrc":r="https://lrc.tor.us",n="debug";break;case"beta":r="https://beta.tor.us",n="debug";break;case"development":r="http://localhost:4050",n="debug";break;default:r="https://app.tor.us/v".concat(o),n="error";break}return{torusUrl:r,logLevel:n}},te=()=>{let e=window.navigator.language||"en-US";const t=e.split("-");return e=Object.prototype.hasOwnProperty.call(F.translations,t[0])?t[0]:"en",e},re=["eth_subscription"],ne=()=>{},ie="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=660,width=375",oe="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=740,width=1315",se="directories=0,titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=700,width=450";function ae(e){let t;try{t=window[e];const r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(r){return r&&(22===r.code||1014===r.code||"QuotaExceededError"===r.name||"NS_ERROR_DOM_QUOTA_REACHED"===r.name)&&t&&0!==t.length}}function ce(){const e=void 0!==window.screenLeft?window.screenLeft:window.screenX,t=void 0!==window.screenTop?window.screenTop:window.screenY,r=1200,n=700,i=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:window.screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:window.screen.height,s=1,a=Math.abs((i-r)/2/s+e),c=Math.abs((o-n)/2/s+t),u="titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=".concat(n/s,",width=").concat(r/s,",top=").concat(c,",left=").concat(a);return u}function ue(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ue(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}b["e"].defaultMaxListeners=100;const le=function(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(n,i)=>n||i.error?t(n||i.error):!r||Array.isArray(i)?e(i):e(i.result)};class he extends b["e"]{constructor(e){let{maxEventListeners:t=100,shouldSendMetadata:r=!0,jsonRpcStreamName:n="provider"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(super(),i()(this,"chainId",void 0),i()(this,"selectedAddress",void 0),i()(this,"_rpcEngine",void 0),i()(this,"networkVersion",void 0),i()(this,"shouldSendMetadata",void 0),i()(this,"isTorus",void 0),i()(this,"_publicConfigStore",void 0),i()(this,"tryPreopenHandle",void 0),i()(this,"enable",void 0),i()(this,"_state",void 0),i()(this,"_jsonRpcConnection",void 0),i()(this,"_sentWarnings",{enable:!1,experimentalMethods:!1,send:!1,publicConfigStore:!1,events:{close:!1,data:!1,networkChanged:!1,notification:!1}}),!E(e))throw new Error(J.errors.invalidDuplexStream());this.isTorus=!0,this.setMaxListeners(t),this._state=de({},he._defaultState),this.selectedAddress=null,this.networkVersion=null,this.chainId=null,this.shouldSendMetadata=r,this._handleAccountsChanged=this._handleAccountsChanged.bind(this),this._handleChainChanged=this._handleChainChanged.bind(this),this._handleUnlockStateChanged=this._handleUnlockStateChanged.bind(this),this._handleConnect=this._handleConnect.bind(this),this._handleDisconnect=this._handleDisconnect.bind(this),this._handleStreamDisconnect=this._handleStreamDisconnect.bind(this),this._sendSync=this._sendSync.bind(this),this._rpcRequest=this._rpcRequest.bind(this),this._warnOfDeprecation=this._warnOfDeprecation.bind(this),this._initializeState=this._initializeState.bind(this),this.request=this.request.bind(this),this.send=this.send.bind(this),this.sendAsync=this.sendAsync.bind(this);const o=new b["c"];C()(e,o,e,this._handleStreamDisconnect.bind(this,"MetaMask")),this._publicConfigStore=new v["ObservableStore"]({storageKey:"Metamask-Config"}),C()(o.createStream("publicConfig"),Object(v["storeAsStream"])(this._publicConfigStore),$.bind(this,"MetaMask PublicConfigStore")),o.ignoreStream("phishing"),this.on("connect",()=>{this._state.isConnected=!0});const s=Object(b["i"])();C()(s.stream,o.createStream(n),s.stream,this._handleStreamDisconnect.bind(this,"MetaMask RpcProvider"));const a=new b["b"];a.push(Object(b["g"])()),a.push(Z()),a.push(s.middleware),this._rpcEngine=a,s.events.on("notification",e=>{const{method:t,params:r}=e;"wallet_accountsChanged"===t?this._handleAccountsChanged(r):"wallet_unlockStateChanged"===t?this._handleUnlockStateChanged(r):"wallet_chainChanged"===t?this._handleChainChanged(r):re.includes(e.method)&&(this.emit("data",e),this.emit("notification",r.result),this.emit("message",{type:t,data:r}))})}get publicConfigStore(){return this._sentWarnings.publicConfigStore||(Y.warn(J.warnings.publicConfigStore),this._sentWarnings.publicConfigStore=!0),this._publicConfigStore}isConnected(){return this._state.isConnected}async request(e){if(!e||"object"!==typeof e||Array.isArray(e))throw w["ethErrors"].rpc.invalidRequest({message:J.errors.invalidRequestArgs(),data:e});const{method:t,params:r}=e;if("string"!==typeof t||0===t.length)throw w["ethErrors"].rpc.invalidRequest({message:J.errors.invalidRequestMethod(),data:e});if(void 0!==r&&!Array.isArray(r)&&("object"!==typeof r||null===r))throw w["ethErrors"].rpc.invalidRequest({message:J.errors.invalidRequestParams(),data:e});return new Promise((e,n)=>{this._rpcRequest({method:t,params:r},le(e,n))})}sendAsync(e,t){this._rpcRequest(e,t)}addListener(e,t){return this._warnOfDeprecation(e),super.addListener(e,t)}on(e,t){return this._warnOfDeprecation(e),super.on(e,t)}once(e,t){return this._warnOfDeprecation(e),super.once(e,t)}prependListener(e,t){return this._warnOfDeprecation(e),super.prependListener(e,t)}prependOnceListener(e,t){return this._warnOfDeprecation(e),super.prependOnceListener(e,t)}async _initializeState(){try{const{accounts:e,chainId:t,isUnlocked:r,networkVersion:n}=await this.request({method:"wallet_getProviderState"});this.emit("connect",{chainId:t}),this._handleChainChanged({chainId:t,networkVersion:n}),this._handleUnlockStateChanged({accounts:e,isUnlocked:r}),this._handleAccountsChanged(e)}catch(e){Y.error("MetaMask: Failed to get initial state. Please report this bug.",e)}finally{Y.info("initialized state"),this._state.initialized=!0,this.emit("_initialized")}}_rpcRequest(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=t;const i=e;if(!Array.isArray(i))if(i.jsonrpc||(i.jsonrpc="2.0"),"eth_accounts"===i.method||"eth_requestAccounts"===i.method)n=(e,n)=>{this._handleAccountsChanged(n.result||[],"eth_accounts"===i.method,r),t(e,n)};else if("wallet_getProviderState"===i.method)return void this._rpcEngine.handle(e,n);this.tryPreopenHandle(i,n)}send(e,t){return this._sentWarnings.send||(Y.warn(J.warnings.sendDeprecation),this._sentWarnings.send=!0),"string"!==typeof e||t&&!Array.isArray(t)?e&&"object"===typeof e&&"function"===typeof t?this._rpcRequest(e,t):this._sendSync(e):new Promise((r,n)=>{try{this._rpcRequest({method:e,params:t},le(r,n,!1))}catch(i){n(i)}})}_sendSync(e){let t;switch(e.method){case"eth_accounts":t=this.selectedAddress?[this.selectedAddress]:[];break;case"eth_coinbase":t=this.selectedAddress||null;break;case"eth_uninstallFilter":this._rpcRequest(e,ne),t=!0;break;case"net_version":t=this.networkVersion||null;break;default:throw new Error(J.errors.unsupportedSync(e.method))}return{id:e.id,jsonrpc:e.jsonrpc,result:t}}_handleConnect(e){this._state.isConnected||(this._state.isConnected=!0,this.emit("connect",{chainId:e}),Y.debug(J.info.connected(e)))}_handleDisconnect(e,t){if(this._state.isConnected||!this._state.isPermanentlyDisconnected&&!e){let r;this._state.isConnected=!1,e?(r=new w["EthereumRpcError"](1013,t||J.errors.disconnected()),Y.debug(r)):(r=new w["EthereumRpcError"](1011,t||J.errors.permanentlyDisconnected()),Y.error(r),this.chainId=null,this._state.accounts=null,this.selectedAddress=null,this._state.isUnlocked=!1,this._state.isPermanentlyDisconnected=!0),this.emit("disconnect",r)}}_handleStreamDisconnect(e,t){$(e,t,this),this._handleDisconnect(!1,t?t.message:void 0)}_handleAccountsChanged(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=e;Array.isArray(n)||(Y.error("MetaMask: Received non-array accounts parameter. Please report this bug.",n),n=[]);for(const i of e)if("string"!==typeof i){Y.error("MetaMask: Received non-string account. Please report this bug.",e),n=[];break}x()(this._state.accounts,n)||(t&&Array.isArray(this._state.accounts)&&this._state.accounts.length>0&&!r&&Y.error('MetaMask: "eth_accounts" unexpectedly updated accounts. Please report this bug.',n),this._state.accounts=n,this.emit("accountsChanged",n)),this.selectedAddress!==n[0]&&(this.selectedAddress=n[0]||null)}_handleChainChanged(){let{chainId:e,networkVersion:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e&&t?"loading"===t?this._handleDisconnect(!0):(this._handleConnect(e),e!==this.chainId&&(this.chainId=e,this._state.initialized&&this.emit("chainChanged",this.chainId))):Y.error("MetaMask: Received invalid network parameters. Please report this bug.",{chainId:e,networkVersion:t})}_handleUnlockStateChanged(){let{accounts:e,isUnlocked:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"boolean"===typeof t?t!==this._state.isUnlocked&&(this._state.isUnlocked=t,this._handleAccountsChanged(e||[])):Y.error("MetaMask: Received invalid isUnlocked parameter. Please report this bug.",{isUnlocked:t})}_warnOfDeprecation(e){!1===this._sentWarnings.events[e]&&(Y.warn(J.warnings.events[e]),this._sentWarnings.events[e]=!0)}}i()(he,"_defaultState",{accounts:null,isConnected:!1,isUnlocked:!1,initialized:!1,isPermanentlyDisconnected:!1,hasEmittedConnection:!1});const pe=e=>({algorithms:e.algorithms||["sha256"],delimiter:e.delimiter||" ",full:e.full||!1}),fe=(e,t)=>{const r={};return e.algorithms.forEach(e=>{r[e]=T()(e).update(t,"utf8").digest("base64")}),r},be=(e,t)=>{let r="";return r+=Object.keys(t.hashes).map(e=>"".concat(e,"-").concat(t.hashes[e])).join(e.delimiter),r},ge=(e,t)=>{const r=pe(e),n={hashes:fe(r,t),integrity:void 0};return n.integrity=be(r,n),r.full?n:n.integrity};class me extends R["EventEmitter"]{constructor(e){let{url:t,target:r,features:n}=e;super(),i()(this,"url",void 0),i()(this,"target",void 0),i()(this,"features",void 0),i()(this,"window",void 0),i()(this,"windowTimer",void 0),i()(this,"iClosedWindow",void 0),this.url=t,this.target=r||"_blank",this.features=n||ce(),this.window=void 0,this.windowTimer=void 0,this.iClosedWindow=!1,this._setupTimer()}_setupTimer(){this.windowTimer=Number(setInterval(()=>{this.window&&this.window.closed&&(clearInterval(this.windowTimer),this.iClosedWindow||this.emit("close"),this.iClosedWindow=!1,this.window=void 0),void 0===this.window&&clearInterval(this.windowTimer)},500))}open(){var e;return this.window=window.open(this.url.href,this.target,this.features),null!==(e=this.window)&&void 0!==e&&e.focus&&this.window.focus(),Promise.resolve()}close(){this.iClosedWindow=!0,this.window&&this.window.close()}redirect(e){e?window.location.replace(this.url.href):window.location.href=this.url.href}}function ye(e){return new Promise((t,r)=>{try{const r=document.createElement("img");r.onload=()=>t(!0),r.onerror=()=>t(!1),r.src=e}catch(n){r(n)}})}const ve=e=>{const{document:t}=e,r=t.querySelector('head > meta[property="og:site_name"]');if(r)return r.content;const n=t.querySelector('head > meta[name="title"]');return n?n.content:t.title&&t.title.length>0?t.title:e.location.hostname};async function we(e){const{document:t}=e;let r=t.querySelector('head > link[rel="shortcut icon"]');return r&&await ye(r.href)?r.href:(r=Array.from(t.querySelectorAll('head > link[rel="icon"]')).find(e=>Boolean(e.href)),r&&await ye(r.href)?r.href:null)}const _e=async()=>({name:ve(window),icon:await we(window)});async function xe(e){try{const t=await _e();e.handle({jsonrpc:"2.0",id:Q(),method:"wallet_sendDomainMetadata",params:t},ne)}catch(t){Y.error({message:J.errors.sendSiteMetadata(),originalError:t})}}const Oe=["host","chainId","networkName"];function ke(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ke(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const Ee={[M.GOOGLE]:!0,[M.FACEBOOK]:!0,[M.REDDIT]:!0,[M.TWITCH]:!0,[M.DISCORD]:!0},Pe="sha384-ChK4+k0VRMpAaC+psywsJYq0CnEqytZvQuy7L2cRWEwqImd7CA7Ep69YzBmHBR2V",Ce="max-age=3600",Ie=["eth_sendTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","eth_getEncryptionPublicKey","eth_decrypt"],je=ae("localStorage");(async function(){try{if("undefined"===typeof document)return;const e=document.createElement("link"),{torusUrl:t}=await ee("production",{check:!1,hash:Pe,version:""});e.href="".concat(t,"/popup"),e.crossOrigin="anonymous",e.type="text/html",e.rel="prefetch",e.relList&&e.relList.supports&&e.relList.supports("prefetch")&&document.head.appendChild(e)}catch(e){Y.warn(e)}})();class Ae{constructor(){let{buttonPosition:e=U.BOTTOM_LEFT,modalZIndex:t=99999,apiKey:r="torus-default"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i()(this,"buttonPosition",U.BOTTOM_LEFT),i()(this,"torusUrl",void 0),i()(this,"torusIframe",void 0),i()(this,"styleLink",void 0),i()(this,"isLoggedIn",void 0),i()(this,"isInitialized",void 0),i()(this,"torusWidgetVisibility",void 0),i()(this,"torusAlert",void 0),i()(this,"nodeDetailManager",void 0),i()(this,"torusJs",void 0),i()(this,"apiKey",void 0),i()(this,"modalZIndex",void 0),i()(this,"alertZIndex",void 0),i()(this,"torusAlertContainer",void 0),i()(this,"isIframeFullScreen",void 0),i()(this,"whiteLabel",void 0),i()(this,"requestedVerifier",void 0),i()(this,"currentVerifier",void 0),i()(this,"embedTranslations",void 0),i()(this,"ethereum",void 0),i()(this,"provider",void 0),i()(this,"communicationMux",void 0),i()(this,"isLoginCallback",void 0),i()(this,"dappStorageKey",void 0),i()(this,"paymentProviders",F.paymentProviders),i()(this,"loginHint",""),this.buttonPosition=e,this.torusUrl="",this.isLoggedIn=!1,this.isInitialized=!1,this.torusWidgetVisibility=!0,this.requestedVerifier="",this.currentVerifier="",this.nodeDetailManager=new p,this.torusJs=new g["a"]({metadataHost:"https://metadata.tor.us",allowHost:"https://signer.tor.us/api/allow"}),this.apiKey=r,g["a"].setAPIKey(r),Object(f["f"])(r),this.modalZIndex=t,this.alertZIndex=t+1e3,this.isIframeFullScreen=!1,this.dappStorageKey=""}async init(){let{buildEnv:e=L.PRODUCTION,enableLogging:t=!1,enabledVerifiers:r=Ee,network:n={host:"mainnet",chainId:null,networkName:"",blockExplorer:"",ticker:"",tickerName:""},loginConfig:i={},showTorusButton:o=!0,integrity:s={check:!1,hash:Pe,version:""},whiteLabel:a,skipTKey:c=!1,useLocalStorage:u=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.isInitialized)throw new Error("Already initialized");const{torusUrl:d,logLevel:l}=await ee(e,s);Y.info(d,"url loaded"),this.torusUrl=d,this.whiteLabel=a,Y.setDefaultLevel(l),t?Y.enableAll():Y.disableAll(),this.torusWidgetVisibility=o;let h="";if(je&&u){const e=window.localStorage.getItem(F.localStorageKey);if(e)h=e;else{const e="torus-app-".concat(Q());window.localStorage.setItem(F.localStorageKey,e),h=e}}this.dappStorageKey=h;const p=new URL(d);p.pathname.endsWith("/")?p.pathname+="popup":p.pathname+="/popup",h&&(p.hash="#dappStorageKey=".concat(h)),this.torusIframe=W('<iframe\n        id="torusIframe"\n        class="torusIframe"\n        src="'.concat(p.href,'"\n        style="display: none; position: fixed; top: 0; right: 0; width: 100%;\n        height: 100%; border: none; border-radius: 0; z-index: ').concat(this.modalZIndex,'"\n      ></iframe>')),this.torusAlertContainer=W('<div id="torusAlertContainer"></div>'),this.torusAlertContainer.style.display="none",this.torusAlertContainer.style.setProperty("z-index",this.alertZIndex.toString());const f=window.document.createElement("link");f.setAttribute("rel","stylesheet"),f.setAttribute("type","text/css"),f.setAttribute("href","".concat(d,"/css/widget.css")),this.styleLink=f;const{defaultLanguage:b=te(),customTranslations:g={}}=this.whiteLabel||{},m=y()(F.translations,g),v=m[b]||F.translations[te()];this.embedTranslations=v.embed;const w=async()=>(await H(),new Promise((e,t)=>{this.torusIframe.onload=async()=>{this._setupWeb3();const o=this.communicationMux.getStream("init_stream");o.on("data",r=>{const{name:n,data:i,error:o}=r;"init_complete"===n&&i.success?(this.isInitialized=!0,this._displayIframe(this.isIframeFullScreen),e(void 0)):o&&t(new Error(o))}),o.write({name:"init_stream",data:{enabledVerifiers:r,loginConfig:i,whiteLabel:this.whiteLabel,buttonPosition:this.buttonPosition,torusWidgetVisibility:this.torusWidgetVisibility,apiKey:this.apiKey,skipTKey:c,network:n}})},window.document.head.appendChild(this.styleLink),window.document.body.appendChild(this.torusIframe),window.document.body.appendChild(this.torusAlertContainer)}));if("production"===e&&s.check){const e="".concat(d,"/popup"),t=await fetch(e,{cache:"reload"});if(t.headers.get("Cache-Control")!==Ce)throw new Error("Unexpected Cache-Control headers, got ".concat(t.headers.get("Cache-Control")));const r=await t.text(),n=ge({algorithms:["sha384"]},r);if(Y.info(n,"integrity"),n!==s.hash)throw this.clearInit(),new Error("Integrity check failed");await w()}else await w()}login(){let{verifier:e="",login_hint:t=""}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isInitialized)throw new Error("Call init() first");return this.requestedVerifier=e,this.loginHint=t,this.ethereum.enable()}logout(){return new Promise((e,t)=>{if(!this.isLoggedIn)return void t(new Error("User has not logged in yet"));const r=this.communicationMux.getStream("logout");r.write({name:"logOut"});const n=this.communicationMux.getStream("status"),i=r=>{r.loggedIn?t(new Error("Some Error Occured")):(this.isLoggedIn=!1,this.currentVerifier="",this.requestedVerifier="",e())};z(n,"data",i)})}async cleanUp(){this.isLoggedIn&&await this.logout(),this.clearInit()}clearInit(){function e(e){return e instanceof Element||e instanceof HTMLDocument}e(this.styleLink)&&window.document.body.contains(this.styleLink)&&(this.styleLink.remove(),this.styleLink=void 0),e(this.torusIframe)&&window.document.body.contains(this.torusIframe)&&(this.torusIframe.remove(),this.torusIframe=void 0),e(this.torusAlertContainer)&&window.document.body.contains(this.torusAlertContainer)&&(this.torusAlert=void 0,this.torusAlertContainer.remove(),this.torusAlertContainer=void 0),this.isInitialized=!1}hideTorusButton(){this.torusWidgetVisibility=!1,this._sendWidgetVisibilityStatus(!1),this._displayIframe()}showTorusButton(){this.torusWidgetVisibility=!0,this._sendWidgetVisibilityStatus(!0),this._displayIframe()}setProvider(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{host:t="mainnet",chainId:r=null,networkName:n=""}=e,i=s()(e,Oe);return new Promise((e,o)=>{const s=this.communicationMux.getStream("provider_change"),a=t=>{const{err:r,success:n}=t.data;Y.info(t),r?o(r):n?e():o(new Error("some error occured"))};z(s,"data",a);const c=Q();this._handleWindow(c,{target:"_blank",features:ie}),s.write({name:"show_provider_change",data:{network:Se({host:t,chainId:r,networkName:n},i),preopenInstanceId:c,override:!1}})})}showWallet(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=this.communicationMux.getStream("show_wallet"),n=e?"/".concat(e):"";r.write({name:"show_wallet",data:{path:n}});const i=e=>{if("show_wallet_instance"===e.name){const{instanceId:r}=e.data,i=new URL("".concat(this.torusUrl,"/wallet").concat(n));i.searchParams.append("integrity","true"),i.searchParams.append("instanceId",r),Object.keys(t).forEach(e=>{i.searchParams.append(e,t[e])}),this.dappStorageKey&&(i.hash="#dappStorageKey=".concat(this.dappStorageKey));const o=new me({url:i,features:oe});o.open()}};z(r,"data",i)}async getPublicAddress(e){let{verifier:t,verifierId:r,isExtended:n=!1}=e;if(!F.supportedVerifierList.includes(t)||!D[t])throw new Error("Unsupported verifier");const i=await this.nodeDetailManager.getNodeDetails(!1,!0),o=i.torusNodeEndpoints,s=i.torusNodePub,a=t,c=D[t];try{const e=await this.torusJs.getUserTypeAndAddress(o,s,{verifier:a,verifierId:r});if("v1"===e.typeOfUser)return n?e:e.address;const t=await this.torusJs.getUserTypeAndAddress(o,s,{verifier:c,verifierId:r},!0);return n?t:t.address}catch(u){if(null!==u&&void 0!==u&&u.message.includes("Verifier + VerifierID has not yet been assigned")){const e=await this.torusJs.getUserTypeAndAddress(o,s,{verifier:c,verifierId:r},!0);return n?e:e.address}throw u}}getUserInfo(e){return new Promise((t,r)=>{if(this.isLoggedIn){const n=this.communicationMux.getStream("user_info_access");n.write({name:"user_info_access_request"});const i=n=>{const{name:i,data:{approved:o,payload:s,rejected:a,newRequest:c}}=n;if("user_info_access_response"===i)if(o)t(s);else if(a)r(new Error("User rejected the request"));else if(c){const n=this.communicationMux.getStream("user_info"),i=e=>{"user_info_response"===e.name&&(e.data.approved?t(e.data.payload):r(new Error("User rejected the request")))};z(n,"data",i);const o=Q();this._handleWindow(o,{target:"_blank",features:ie}),n.write({name:"user_info_request",data:{message:e,preopenInstanceId:o}})}};z(n,"data",i)}else r(new Error("User has not logged in yet"))})}initiateTopup(e,t){return new Promise((r,n)=>{if(this.isInitialized){const{errors:i,isValid:o}=G(e,t);if(!o)return void n(new Error(JSON.stringify(i)));const s=this.communicationMux.getStream("topup"),a=e=>{"topup_response"===e.name&&(e.data.success?r(e.data.success):n(new Error(e.data.error)))};z(s,"data",a);const c=Q();this._handleWindow(c),s.write({name:"topup_request",data:{provider:e,params:t,preopenInstanceId:c}})}else n(new Error("Torus is not initialized yet"))})}_handleWindow(e){let{url:t,target:r,features:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e){const i=this.communicationMux.getStream("window"),o=new URL(t||"".concat(this.torusUrl,"/redirect?preopenInstanceId=").concat(e));this.dappStorageKey&&(o.hash?o.hash+="&dappStorageKey=".concat(this.dappStorageKey):o.hash="#dappStorageKey=".concat(this.dappStorageKey));const s=new me({url:o,target:r,features:n});if(s.open(),!s.window)return void this._createPopupBlockAlert(e,o.href);i.write({name:"opened_window",data:{preopenInstanceId:e}});const a=t=>{let{preopenInstanceId:r,close:n}=t;r===e&&n&&(s.close(),i.removeListener("data",a))};i.on("data",a),s.once("close",()=>{i.write({data:{preopenInstanceId:e,closed:!0}}),i.removeListener("data",a)})}}_setEmbedWhiteLabel(e){const{theme:t}=this.whiteLabel||{};if(t){const{isDark:r=!1,colors:n={}}=t;r&&e.classList.add("torus-dark"),n.torusBrand1&&e.style.setProperty("--torus-brand-1",n.torusBrand1),n.torusGray2&&e.style.setProperty("--torus-gray-2",n.torusGray2)}}_getLogoUrl(){var e,t;let r="".concat(this.torusUrl,"/images/torus_icon-blue.svg");var n,i;null!==(e=this.whiteLabel)&&void 0!==e&&null!==(t=e.theme)&&void 0!==t&&t.isDark?r=(null===(n=this.whiteLabel)||void 0===n?void 0:n.logoLight)||r:r=(null===(i=this.whiteLabel)||void 0===i?void 0:i.logoDark)||r;return r}_sendWidgetVisibilityStatus(e){const t=this.communicationMux.getStream("torus-widget-visibility");t.write({data:e})}_displayIframe(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t={};if(e)t.display="block",t.width="100%",t.height="100%",t.top="0px",t.right="0px",t.left="0px",t.bottom="0px";else switch(t.display=this.torusWidgetVisibility?"block":"none",t.height="70px",t.width="70px",this.buttonPosition){case U.TOP_LEFT:t.top="0px",t.left="0px",t.right="auto",t.bottom="auto";break;case U.TOP_RIGHT:t.top="0px",t.right="0px",t.left="auto",t.bottom="auto";break;case U.BOTTOM_RIGHT:t.bottom="0px",t.right="0px",t.top="auto",t.left="auto";break;case U.BOTTOM_LEFT:default:t.bottom="0px",t.left="0px",t.top="auto",t.right="auto";break}Object.assign(this.torusIframe.style,t),this.isIframeFullScreen=e}_setupWeb3(){Y.info("setupWeb3 running");const e=new b["a"]({name:"embed_metamask",target:"iframe_metamask",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),t=new b["a"]({name:"embed_comm",target:"iframe_comm",targetWindow:this.torusIframe.contentWindow,targetOrigin:new URL(this.torusUrl).origin}),r=new he(e),n=e=>{const t=r[e];r[e]=function(e){if(e&&"eth_requestAccounts"===e)return r.enable();for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return t.apply(this,[e,...i])}};n("send"),n("sendAsync"),r.enable=()=>new Promise((e,t)=>{r.sendAsync({jsonrpc:"2.0",id:Q(),method:"eth_requestAccounts",params:[]},(r,n)=>{const{result:i}=n||{};if(r)setTimeout(()=>{t(r)},50);else if(Array.isArray(i)&&i.length>0){const r=()=>{if(""!==this.requestedVerifier&&this.currentVerifier!==this.requestedVerifier){const{requestedVerifier:r}=this;this.logout().then(n=>{this.requestedVerifier=r,this._showLoginPopup(!0,e,t)}).catch(e=>t(e))}else e(i)};this.isLoggedIn?r():this.isLoginCallback=r}else this._showLoginPopup(!0,e,t)})}),r.tryPreopenHandle=(e,t)=>{const n=e;if(!Array.isArray(n)&&Ie.includes(n.method)){const e=Q();this._handleWindow(e,{target:"_blank",features:se}),n.preopenInstanceId=e}r._rpcEngine.handle(n,t)};const i=new Proxy(r,{deleteProperty:()=>!0});this.ethereum=i;const o=Object(b["l"])(t);this.communicationMux=o;const s=o.getStream("window");s.on("data",e=>{"create_window"===e.name&&this._createPopupBlockAlert(e.data.preopenInstanceId,e.data.url)});const a=o.getStream("widget");a.on("data",e=>{const{data:t}=e;this._displayIframe(t)});const c=o.getStream("status");c.on("data",e=>{e.loggedIn?(this.isLoggedIn=e.loggedIn,this.currentVerifier=e.verifier):this._displayIframe(),this.isLoginCallback&&(this.isLoginCallback(),delete this.isLoginCallback)}),this.provider=i,this.provider.shouldSendMetadata&&xe(this.provider._rpcEngine),r._initializeState(),Y.debug("Torus - injected provider")}_showLoginPopup(e,t,r){const n=e=>{const{err:n,selectedAddress:i}=e;n?(Y.error(n),r&&r(n)):t&&t([i]),this.isIframeFullScreen&&this._displayIframe()},i=this.communicationMux.getStream("oauth");if(this.requestedVerifier){z(i,"data",n);const t=Q();this._handleWindow(t),i.write({name:"oauth",data:{calledFromEmbed:e,verifier:this.requestedVerifier,preopenInstanceId:t,login_hint:this.loginHint}})}else this._displayIframe(!0),z(i,"data",n),i.write({name:"oauth_modal",data:{calledFromEmbed:e}})}_createPopupBlockAlert(e,t){const r=this._getLogoUrl(),n=W('<div id="torusAlert" class="torus-alert--v2">'+'<div id="torusAlert__logo"><img src="'.concat(r,'" /></div>')+"<div>"+'<h1 id="torusAlert__title">'.concat(this.embedTranslations.actionRequired,"</h1>")+'<p id="torusAlert__desc">'.concat(this.embedTranslations.pendingAction,"</p>")+"</div></div>"),i=W('<div><a id="torusAlert__btn">'.concat(this.embedTranslations.continue,"</a></div>")),o=W('<div id="torusAlert__btn-container"></div>');o.appendChild(i),n.appendChild(o);const s=()=>{i.addEventListener("click",()=>{this._handleWindow(e,{url:t,target:"_blank",features:se}),n.remove(),0===this.torusAlertContainer.children.length&&(this.torusAlertContainer.style.display="none")})};this._setEmbedWhiteLabel(n);const a=()=>{this.torusAlertContainer.style.display="block",this.torusAlertContainer.appendChild(n)};K(a),K(s)}}var Te=r("b089");function Re(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Me(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Re(Object(r),!0).forEach((function(t){i()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Re(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}class De extends Te["e"]{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),i()(this,"name",Te["i"].TORUS_EVM),i()(this,"adapterNamespace",Te["c"].EIP155),i()(this,"currentChainNamespace",Te["f"].EIP155),i()(this,"type",Te["a"].EXTERNAL),i()(this,"status",Te["d"].NOT_READY),i()(this,"torusInstance",null),i()(this,"torusWalletOptions",void 0),i()(this,"initParams",void 0),i()(this,"loginSettings",{}),i()(this,"rehydrated",!1),this.torusWalletOptions=e.adapterSettings||{},this.initParams=e.initParams||{},this.loginSettings=e.loginSettings||{},this.chainConfig=e.chainConfig||null}get provider(){return this.status===Te["d"].CONNECTED&&this.torusInstance?this.torusInstance.provider:null}set provider(e){throw new Error("Not implemented")}async init(e){let t;if(super.checkInitializationRequirements(),this.chainConfig){const{chainId:e,blockExplorer:r,displayName:n,rpcTarget:i}=this.chainConfig;t={chainId:parseInt(e,16),host:i,blockExplorer:r,networkName:n}}else{this.chainConfig=Object(Te["m"])(Te["f"].EIP155,1);const{blockExplorer:e,displayName:r}=this.chainConfig;t={chainId:1,host:"mainnet",blockExplorer:e,networkName:r}}this.torusInstance=new Ae(this.torusWalletOptions),await this.torusInstance.init(Me(Me({showTorusButton:!1},this.initParams),{},{network:t})),this.status=Te["d"].READY,this.emit(Te["b"].READY,Te["i"].TORUS_EVM);try{e.autoConnect&&(this.rehydrated=!0,await this.connect())}catch(r){j.a.error("Failed to connect with torus evm provider",r),this.emit(Te["b"].ERRORED,r)}}async connect(){if(super.checkConnectionRequirements(),!this.torusInstance)throw Te["j"].notReady("Torus wallet is not initialized");this.status=Te["d"].CONNECTING,this.emit(Te["b"].CONNECTING,{adapter:Te["i"].TORUS_EVM});try{await this.torusInstance.login(this.loginSettings);const{chainId:e}=this.torusInstance.provider;if(e&&parseInt(e)!==parseInt(this.chainConfig.chainId,16))throw Te["j"].fromCode(5e3,"Not connected to correct chainId. Expected: ".concat(this.chainConfig.chainId,", Current: ").concat(e));return this.status=Te["d"].CONNECTED,this.torusInstance.showTorusButton(),this.emit(Te["d"].CONNECTED,{adapter:Te["i"].TORUS_EVM,reconnected:this.rehydrated}),this.provider}catch(e){throw this.status=Te["d"].READY,this.rehydrated=!1,this.emit(Te["d"].ERRORED,e),e instanceof Te["l"]?e:Te["k"].connectionError("Failed to login with torus wallet")}}async disconnect(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{cleanup:!1};if(this.status!==Te["d"].CONNECTED)throw Te["k"].notConnectedError("Not connected with wallet");if(!this.torusInstance)throw Te["j"].notReady("Torus wallet is not initialized");await this.torusInstance.logout(),this.torusInstance.hideTorusButton(),e.cleanup?(this.status=Te["d"].NOT_READY,this.torusInstance=null):this.status=Te["d"].READY,this.rehydrated=!1,this.emit(Te["b"].DISCONNECTED)}async getUserInfo(){if(this.status!==Te["d"].CONNECTED)throw Te["k"].notConnectedError("Not connected with wallet");if(!this.torusInstance)throw Te["j"].notReady("Torus wallet is not initialized");const e=await this.torusInstance.getUserInfo("");return e}setAdapterSettings(e){}}},"8cd5":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMessageFromCode=t.serializeError=t.EthereumProviderError=t.EthereumRpcError=t.ethErrors=t.errorCodes=void 0;const n=r("e369");Object.defineProperty(t,"EthereumRpcError",{enumerable:!0,get:function(){return n.EthereumRpcError}}),Object.defineProperty(t,"EthereumProviderError",{enumerable:!0,get:function(){return n.EthereumProviderError}});const i=r("2966");Object.defineProperty(t,"serializeError",{enumerable:!0,get:function(){return i.serializeError}}),Object.defineProperty(t,"getMessageFromCode",{enumerable:!0,get:function(){return i.getMessageFromCode}});const o=r("6d79");Object.defineProperty(t,"ethErrors",{enumerable:!0,get:function(){return o.ethErrors}});const s=r("e017");Object.defineProperty(t,"errorCodes",{enumerable:!0,get:function(){return s.errorCodes}})},"95b2":function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r("ec0f"),t),i(r("fbaf"),t),i(r("e817"),t),i(r("71a9"),t),i(r("f452"),t)},"970b":function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r("d9e2"),e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},"9bdd":function(e,t,r){var n=r("825a"),i=r("2a62");e.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(s){i(e,"throw",s)}}},a128:function(e,t,r){r("4ec9"),r("d3b7"),r("3ca3"),r("ddb0"),r("d9e2");var n=r("36c6"),i=r("4a4b"),o=r("c5f7"),s=r("b17c");function a(t){var r="function"===typeof Map?new Map:void 0;return e.exports=a=function(e){if(null===e||!o(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return s(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.__esModule=!0,e.exports["default"]=e.exports,a(t)}e.exports=a,e.exports.__esModule=!0,e.exports["default"]=e.exports},a34a:function(e,t,r){e.exports=r("96cf")},a630:function(e,t,r){var n=r("23e7"),i=r("4df4"),o=r("1c7e"),s=!o((function(e){Array.from(e)}));n({target:"Array",stat:!0,forced:s},{from:i})},b17c:function(e,t,r){r("4ae1"),r("d3b7"),r("f8c9");var n=r("4a4b"),i=r("6f8f");function o(t,r,s){return i()?(e.exports=o=Reflect.construct,e.exports.__esModule=!0,e.exports["default"]=e.exports):(e.exports=o=function(e,t,r){var i=[null];i.push.apply(i,t);var o=Function.bind.apply(e,i),s=new o;return r&&n(s,r.prototype),s},e.exports.__esModule=!0,e.exports["default"]=e.exports),o.apply(null,arguments)}e.exports=o,e.exports.__esModule=!0,e.exports["default"]=e.exports},b64b:function(e,t,r){var n=r("23e7"),i=r("7b0b"),o=r("df75"),s=r("d039"),a=s((function(){o(1)}));n({target:"Object",stat:!0,forced:a},{keys:function(e){return o(i(e))}})},bb2f:function(e,t,r){var n=r("d039");e.exports=!n((function(){return Object.isExtensible(Object.preventExtensions({}))}))},c5f7:function(e,t,r){function n(e){return-1!==Function.toString.call(e).indexOf("[native code]")}r("d3b7"),r("25f0"),e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},d28b:function(e,t,r){var n=r("746f");n("iterator")},d86b:function(e,t,r){var n=r("d039");e.exports=n((function(){if("function"==typeof ArrayBuffer){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}))},e017:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.errorValues=t.errorCodes=void 0,t.errorCodes={rpc:{invalidInput:-32e3,resourceNotFound:-32001,resourceUnavailable:-32002,transactionRejected:-32003,methodNotSupported:-32004,limitExceeded:-32005,parse:-32700,invalidRequest:-32600,methodNotFound:-32601,invalidParams:-32602,internal:-32603},provider:{userRejectedRequest:4001,unauthorized:4100,unsupportedMethod:4200,disconnected:4900,chainDisconnected:4901}},t.errorValues={"-32700":{standard:"JSON RPC 2.0",message:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."},"-32600":{standard:"JSON RPC 2.0",message:"The JSON sent is not a valid Request object."},"-32601":{standard:"JSON RPC 2.0",message:"The method does not exist / is not available."},"-32602":{standard:"JSON RPC 2.0",message:"Invalid method parameter(s)."},"-32603":{standard:"JSON RPC 2.0",message:"Internal JSON-RPC error."},"-32000":{standard:"EIP-1474",message:"Invalid input."},"-32001":{standard:"EIP-1474",message:"Resource not found."},"-32002":{standard:"EIP-1474",message:"Resource unavailable."},"-32003":{standard:"EIP-1474",message:"Transaction rejected."},"-32004":{standard:"EIP-1474",message:"Method not supported."},"-32005":{standard:"EIP-1474",message:"Request limit exceeded."},4001:{standard:"EIP-1193",message:"User rejected the request."},4100:{standard:"EIP-1193",message:"The requested account and/or method has not been authorized by the user."},4200:{standard:"EIP-1193",message:"The requested method is not supported by this Ethereum provider."},4900:{standard:"EIP-1193",message:"The provider is disconnected from all chains."},4901:{standard:"EIP-1193",message:"The provider is disconnected from the specified chain."}}},e369:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EthereumProviderError=t.EthereumRpcError=void 0;const n=r("375a");class i extends Error{constructor(e,t,r){if(!Number.isInteger(e))throw new Error('"code" must be an integer.');if(!t||"string"!==typeof t)throw new Error('"message" must be a nonempty string.');super(t),this.code=e,void 0!==r&&(this.data=r)}serialize(){const e={code:this.code,message:this.message};return void 0!==this.data&&(e.data=this.data),this.stack&&(e.stack=this.stack),e}toString(){return n.default(this.serialize(),a,2)}}t.EthereumRpcError=i;class o extends i{constructor(e,t,r){if(!s(e))throw new Error('"code" must be an integer such that: 1000 <= code <= 4999');super(e,t,r)}}function s(e){return Number.isInteger(e)&&e>=1e3&&e<=4999}function a(e,t){if("[Circular]"!==t)return t}t.EthereumProviderError=o},e817:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MergedStore=void 0;const n=r("71a9");class i extends n.ObservableStore{constructor(e=[]){super({}),this._children=e,e.forEach(e=>this._addChild(e)),this._updateWholeState()}_addChild(e){e.subscribe(()=>this._updateWholeState())}_updateWholeState(){const e=this._children.map(e=>e.getState()),t=Object.assign({},...e);this.putState(t)}}t.MergedStore=i},ec0f:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.storeAsStream=void 0;const n=r("d485");class i extends n.Duplex{constructor(e){super({objectMode:!0}),this.resume(),this.handler=e=>this.push(e),this.obsStore=e,this.obsStore.subscribe(this.handler)}pipe(e,t){const r=super.pipe(e,t);return e.write(this.obsStore.getState()),r}_write(e,t,r){this.obsStore.putState(e),r()}_read(e){}_destroy(e,t){this.obsStore.unsubscribe(this.handler),super._destroy(e,t)}}function o(e){return new i(e)}t.storeAsStream=o},ed6d:function(e,t,r){r("d9e2");var n=r("4a4b");function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)}e.exports=i,e.exports.__esModule=!0,e.exports["default"]=e.exports},f0e4:function(e,t,r){function n(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}r("b64b"),e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},f183:function(e,t,r){var n=r("23e7"),i=r("e330"),o=r("d012"),s=r("861d6"),a=r("1a2d"),c=r("9bf2").f,u=r("241c"),d=r("057f"),l=r("4fad"),h=r("90e3"),p=r("bb2f"),f=!1,b=h("meta"),g=0,m=function(e){c(e,b,{value:{objectID:"O"+g++,weakData:{}}})},y=function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,b)){if(!l(e))return"F";if(!t)return"E";m(e)}return e[b].objectID},v=function(e,t){if(!a(e,b)){if(!l(e))return!0;if(!t)return!1;m(e)}return e[b].weakData},w=function(e){return p&&f&&l(e)&&!a(e,b)&&m(e),e},_=function(){x.enable=function(){},f=!0;var e=u.f,t=i([].splice),r={};r[b]=1,e(r).length&&(u.f=function(r){for(var n=e(r),i=0,o=n.length;i<o;i++)if(n[i]===b){t(n,i,1);break}return n},n({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:d.f}))},x=e.exports={enable:_,fastKey:y,getWeakData:v,onFreeze:w};o[b]=!0},f452:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.storeTransformStream=void 0;const n=r("11d3");function i(e){return n.obj((t,r,n)=>{try{const r=e(t);return void n(null,r)}catch(i){return void n(i)}})}t.storeTransformStream=i},fb6a:function(e,t,r){"use strict";var n=r("23e7"),i=r("da84"),o=r("e8b5"),s=r("68ee"),a=r("861d6"),c=r("23cb"),u=r("07fa"),d=r("fc6a"),l=r("8418"),h=r("b622"),p=r("1dde"),f=r("f36a"),b=p("slice"),g=h("species"),m=i.Array,y=Math.max;n({target:"Array",proto:!0,forced:!b},{slice:function(e,t){var r,n,i,h=d(this),p=u(h),b=c(e,p),v=c(void 0===t?p:t,p);if(o(h)&&(r=h.constructor,s(r)&&(r===m||o(r.prototype))?r=void 0:a(r)&&(r=r[g],null===r&&(r=void 0)),r===m||void 0===r))return f(h,b,v);for(n=new(void 0===r?m:r)(y(v-b,0)),i=0;b<v;b++,i++)b in h&&l(n,i,h[b]);return n.length=i,n}})},fbaf:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ComposedStore=void 0;const n=r("71a9");class i extends n.ObservableStore{constructor(e){super({}),this._children=e||{},Object.keys(this._children).forEach(e=>{const t=this._children[e];this._addChild(e,t)})}_addChild(e,t){const r=t=>{const r=this.getState();r[e]=t,this.putState(r)};t.subscribe(r),r(t.getState())}}t.ComposedStore=i}}]);
//# sourceMappingURL=chunk-4e8cb99d.3e872efe.js.map